# 생성자에 매개변수가 많다면 빌더를 고려하라

## 생성자와 정적 팩터리의 제약
- 선택적 매개변수가 많을 때 적절히 대응하기 어려움
- [대안1] 점층적 생성자 패턴: 매개변수를 1개씩 늘려가며 생성자를 n개 만드는 방식
    * 너무 복잡해서 읽거나 쓰기 어려움
    * 설정하기 싫은 값도 설정해줘야 함
- [대안2] 자바빈즈 패턴: 매개변수 없는 생성자로 객체를 만들고 세터로 설정하는 방식
    * 객체 하나를 만들기 위해 메서드를 여럿 호출해야 함
    * 객체가 완전히 생성되기 전까지 일관성을 잃음 (디버깅의 어려움, 불변 못만듦, 스레드 안정성 확보 어려움)

## 빌더 패턴
- 필수 매개변수로 생성자를 호출해 빌더 객체를 얻고, 필요한 파라미터를 선택하고, build()를 호출해 객체를 얻는 방식
    * 빌더는 대개 정적 멤버 클래스로 만들어 둔다 (ex. `public static class Builder {...}`)
    * 빌더의 세터 메서드는 자신을 반환하기 때문에 연쇄적 호출(fluent api, method chaining)이 가능
- 계층적으로 설계된 클래스와 함께 쓰기 좋음
    * 계층 구조가 `Animal > Fish / Animal > Bird` 라고 할 때
    * `Animal`안의 Builder를 Fish와 Bird에서 extends 하면서 각각 자기 자신을 리턴
    * Animal의 Builder는 Animal을 리턴하게 정의되어 있는데 그 하위 타입을 리턴하는 이런 경우를 covariant return typing 이라 함 (사용처가 형변환을 신경쓰지 않고 빌더 사용 가능)
- 장점
    * 대안1의 `안전성` + 대안2의 `가독성` 겸비
    * 유연함
- 단점
    * 객체를 만들기 위해 빌더를 만들어 줘야 함 (lombok은 `@Builder` 를 제공하여 편의성을 제공함)
    * 매개변수가 4개 이상은 되어야 값어치를 함 (그러나 시간이 지날수록 매개변수는 늘어나므로 애초에 빌더를 쓰는 게 나을 수 있음)