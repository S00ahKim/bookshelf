# 01. 자바 8, 9, 10, 11: 무슨 일이 일어나고 있는가?

## 자바의 버전별 흐름
> 멀티코어 병렬성에 대한 진화 과정
- 1: 스레드 사용 (스레드, 락, 메모리 모델 등)
- 5: 스레드 풀, 병렬 실행 커넥션
- 7: 포크/조인 프레임워크
- 8: 간결한 코드로 멀티코어 프로세서 사용
    * 스트림 API (작성은 고수준, 실행은 알아서 저수준 선택)
    * 메서드에 코드를 전달하는 기법 (메소드 참조, 람다)
    * 인터페이스의 디폴트 메서드
- 9: 리액티브 프로그래밍 (리액티브 스트림 툴킷RxJava을 표준으로 제공)


## 자바의 변화
- 모든 언어는 장단점을 가진다
    * C, C++: 안전성은 부족하나 작은 런타임 풋프린트 -> 운영체제, 임베디드
    * 자바, C#: 런타임 풋프린트의 여유가 필요하나 안전함 -> 애플리케이션
- 자바의 위치
    * 좋은 라이브러리를 제공하는 잘 설계된 객체지향 언어로 대중적 위치 획득
    * 빅데이터 환경에서 병렬 처리의 필요성 대두
    * 하드웨어/개발자의 기대에 부응하는 방식으로 변화를 추구하며 인기를 유지 중
- 자바 8 설계의 큰 개념
    * 스트림 처리
        + 스트림? 한 번에 **하나씩** 만들어지는 연속적인 데이터 항목의 모임
        + 파이프라인화 가능: 하나씩 읽고 (입력 스트림) 하나씩 출력(출력 스트림)하여 연결될 수 있음 ex. `유닉스 파이프(|)`
        + 한 번에 한 항목 처리 -> **고수준 추상화하여 일련의 스트림으로 처리**
    * 동작 파라미터화
        + 메서드(작성한 코드)를 다른 메서드에 파라미터로 넘겨줄 수 있음
    * 병렬성
        + 메서드의 파라미터로 전달되는 코드는 안전하게 실행할 수 있어야 한다 (공유 가변 데이터 접근 않는 stateless한)
        + 명령형 패러다임과 달리 **함수형 패러다임**은 다른 부작용 없이 지정된 기능만 수행함
            - 어떻게 수행하는지(자료구조를 탐색하며 컴포넌트를 *수정*함 등)보다 무엇을 할 것인지가 우선시됨
            - 함수형 패러다임의 도입으로 객체지향/함수형이라는 두 솔루션을 얻게 됨


## 자바 함수
- 자바 8은 함수를 새로운 값의 형식으로 추가했다.
- 이급 시민을 일급 시민으로
    * 프로그래밍 언어의 핵심은 **값을 바꾸는 것**이다.
    * **값의 구조**를 표현하는 구조체 중 전달 가능한 것을 **일급 객체**라고 한다. 
    * 자바 8 이전의 메서드, 클래스는 이급 객체였다.
    * 자바 8 설계자들은 이급 객체를 일급 객체로 만들었다.
    * 이로써 더 수월하게 프로그래밍할 수 있게 되었다. `cf. 스칼라, 그루비`
- 새로운 기능들
    * 메서드 참조: 메서드를 객체로 감싸서 전달 -> `::` 으로 참조
    * 메서드 전달: 필요할 때마다 코드 복붙 -> 하나의 메서드를 공유 (람다 포함)
        + cf. `Function<Apple, Boolean>` 보다 true/false로 바로 리턴해주는 `Predicate<Apple>`이 효율적이라 표준
    * 람다: 한 번 사용하는 메서드는 따로 정의하지 않고 익명 함수로 선언 / 복잡해지면 메서드 참조 권장
    * 스트림 API: 멀티코어 환경에 대응하여 병렬성을 갖추기 위해 연산집합을 포함하여 만듦
        + 컬렉션과 유사함
        + 컬렉션-스트림 간 변환 메서드 제공: map, reduce


## 스트림
> - 컬렉션(데이터의 저장과 접근에 중점) -> 스트림(데이터에 무슨 계산을 할 것인지에 중점)
> - 가장 빠른 컬렉션 필터링 = 컬렉션을 스트림으로 만들어 작업하고 다시 컬렉션으로 복원
### 모호함과 반복적인 코드 문제 해결
- 컬렉션만으로 필터링/그룹화 등을 만들려면 코드가 복잡하다.
    * 루프를 이용해서 반복하면서 작업 수행하는 외부 반복 사용
    * 이러한 패턴은 반복되기 때문에 라이브러리에서 패턴을 제공하자는 논의가 시작됨
- 스트림을 사용하면 훨씬 간결하다.
    * 라이브러리 내부에서 모든 데이터가 처리되는 내부 반복 사용

### 멀티코어 활용 어려움 문제 해결
- 기존에는 일일이 어떻게 멀티코어에 일을 분배할 것인지 지정했다.
- 스트림은 작업 대상을 포크(분할)하고 작업을 수행한 뒤 합치는 식으로 동작한다.
    * `parallecStream()`을 명기해야 여러 코어를 사용함
    * 이러한 작업이 실행되는 동안 상호작용이 없음까지 보장함


## 디폴트 메서드
### 외부 컴포넌트의 활용법 변천사
- ~7: JAR 파일 제공받아서 사용 / 인터페이스 변경시 모든 구현 변경
- 8: 인터페이스를 쉽게 바꿀 수 있도록 디폴트 메서드 지원
- 9: 패키지 모음을 포함하는 모듈을 정의하는 문법 제공

### 디폴트 메서드란?
- 특정 프로그램의 구현에 도움을 주는 기능이 아니라 미래에 프로그램이 **쉽게 변화하는 환경을 제공**하는 기능
- 구현 클래스에서 구현하지 않아도 되는 메서드를 인터페이스에 추가할 수 있는 기능
- 메서드 내용을 클래스 구현이 아니라 인터페이스의 일부로 포함시키는 것
- `default` 키워드
- 장점? 인터페이스, 라이브러리의 간결성 유지 및 재컴파일의 감소


## 함수형 언어에서 가져온 다른 유용한 아이디어
- 자바에 포함된 함수형 패러다임: **메서드와 람다의 일급객체화** & **가변 공유 상태가 없는 병렬 실행** `ex. 스트림`
- null 회피: `Optional<T>`
- 구조적 패턴 매칭: 자바 8은 완벽 지원하지는 않음. 14에서 제안됨. switch와 유사함.