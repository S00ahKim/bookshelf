# 뉴스 피드 시스템 설계

## 뉴스 피드 시스템
- 지속적으로 업데이트되는 스토리들

## 설계
1. 피드 발행
    * 포스팅 저장 -> DB, 캐시
    * 포스팅 전송(fanout) -> 친구의 피드
        + 쓰기 시점에 팬아웃(push 모델)
            - 쓰기 완료 시점에 친구의 캐시에 포스팅 기록
            - 장점: 즉시 전송 & 기록되면서 피드가 갱신되어 읽기 시간이 짧아짐
            - 단점: 핫키(친구가 많은 사용자) & 서비스 이용률이 낮은 친구의 경우 자원 낭비
        + 읽기 시점에 팬아웃(pull 모델)
            - 요청 기반 모델, 사용자가 피드 읽는 시점에 새로운 포스트 가져옴
            - 장점: 서비스 이용률이 낮은 사용자의 경우 자원 절약 & 핫키 문제 없음
            - 단점: 읽는 데 많은 시간이 소요
        + 하이브리드 모델
            - 대부분의 사용자 -> 속도를 위해 push 모델
            - 친구/팔로워가 많은 사용자 -> 과부하 방지를 위해 pull 모델
            - 안정 해시로 요청과 데이터를 분산해 핫키 문제 줄임
    * 알림 -> 친구
2. 피드 생성
    * 피드 서비스 & 캐시
        + 이미지/비디오는 CDN을 사용해 빠르게 읽게 함
3. 공통
    * 앞단에 로드밸런서를 두어 부하 분산
    * DB 앞단에 캐시를 두어 최신 데이터를 빠르게 읽게 함 (캐시는 종류별/계층별로 둠)

## 밑줄
- 면접관의 의도는 무엇이었는지 질문을 통해 알아내는 것이다 (p. 184)
- 설계를 진행하고 기술을 선택할 때는 그 배경에 어떤 타협적 결정들(trade-off)이 있었는지 잘 이해하고 설명할 수 있어야 한다. (p. 195)

## 질문
- 그래프 데이터베이스란?
    * 노드 간의 관계(엣지)를 를 저장하고 탐색하도록 특별히 구축된 DB
    * 질의에는 GQL을 사용
      ```
      MATCH (nicole:Actor {name: 'Nicole Kidman'})-[:ACTED_IN]->(movie:Movie)
      WHERE movie.year < $yearParameter
      RETURN movie
      ```
    * ex. 카탈로그에 주제별 정보 배치, 위키피디아 문서 모델링