# 스프링 프로젝트 시작하기
> 스프링은 유연하게 설계되어 아키텍처 종류/프로젝트 구성법에 자유도가 높다

## 자바 엔터프라이즈 플랫폼과 스프링 애플리케이션
- 스프링의 주 용도: 엔터프라이즈 애플리케이션 개발
- 가장 많이 사용되는 구조 = 클라이언트(웹 브라우저) - 백엔드(DB), a.k.a. DB를 사용하는 웹 애플리케이션
- 자바 서버가 받아들일 수 있는 요청으로 보내기만 한다면 클라이언트의 종류는 무관함
- 애플리케이션을 서버에 배포하려면 **JavaEE**(or J2EE)가 필요하다.
    1. WAS(웹 애플리케이션 서버)
        * JavaEE의 대부분의 표준 기술을 지원
        * 다양한 형태의 모듈로 배포 가능
        * 가격대가 높은 대신 안정적인 리소스 관리를 지원 (관리/모니터링 기능 뛰어남)
    2. 경량급WAS / 서블릿 컨테이너
        * 톰캣 또는 제티 등
            - 스프링 개발진 중에 톰캣 개발자들이 많아서 스프링에 최적화된 tcServer를 개발함
        * EJB, 리소스 커넥터 등이 굳이 필요하지 않은 경우
        * 선언적 트랜잭션/보안, DB 연결 풀링 등 다양한 부가기능을 라이브러리로 제공
        * 가볍고 빠르며 저렴한 비용으로 사용할 수 있음
- 배포 단위
    * 독립 웹 모듈
        + war로 패키징된 독립 웹 모듈
        + 톰캣 등 서블릿 컨테이너를 사용한다면 유일한 방법
        + 단순하고 편리한 배포 단위
    * 엔터프라이즈 애플리케이션
        + ear로 패키징된 엔터프라이즈 애플리케이션
        + 앱 내에서 EJB를 긴밀하게 사용하는 등의 경우
    * 백그라운드 서비스 모듈
        + rar로 패키징된 모듈
        + 리소스 커넥터 배포할 때 사용하는 방법
        + UI 필요 없고 서버 내에서 백그라운드 서비스처럼 사용하는 경우

## 개발도구와 환경
- JavaSE, JavaEE
    * 스프링은 버전에 따라 특정 JDK를 필요로 함
    * JavaSE/JDK (스프링 3.0의 경우, JDK 5.0 이상)
    * JavaEE/J2EE (스프링 3.0의 경우, J2EE 1.4 또는 JavaEE 5.0 이상)
- IDE: 이클립스, 인텔리제이 등
- STS(스프링 소스 툴 서비스): 최신 이클립스 기반 주요 플러그인과 도구를 모아 개발에 최적화한 IDE
    * 각종 플러그인으로 편리한 개발을 도움 ex. 빈 클래스 이름 자동완성, 오류검증 기능, 각종 위저드 등
- 라이브러리 관리와 빌드 툴
    * 직/간접적으로 참조하는 라이브러리는 수십개를 훌쩍 넘음
    * 라이브러리마다 버전이 따로 존재해서 오류 가능성 있음
    * 라이브러리 의존 관계 관리의 어려움을 해결하는 **재패키징**
    * 무슨 라이브러리를 사용할지 선정 필요
        + 애플리케이션에 무슨 기능이 들어가는지 정리
        + 그 기능을 지원하는 많은 라이브러리 중 무엇을 사용할지 선정
        + 대개 시행착오를 거침
        + 불필요한 라이브러리는 모듈 파일의 크기도 커지고 관리가 어려우므로 꼭 필요한 것만 넣을 것
- 빌드 툴과 라이브러리 관리
    * 대부분의 IDE에는 자동 빌드 기능이 있으나, 환경에 독립적인 빌드 툴을 함께 사용해야 함
    * Maven
        + 개발 과정에서 필요한 빌드, 테스트, 배치, 문서화, 리포팅 등을 지원하는 종합 프로젝트 관리 툴
        + POM이라는 프로젝트 모델 정보 이용. 라이브러리를 선언만 하면 자동으로 다운로드 받음. 전이적이라 선언 안했지만 필요한 것도 다운로드함.
        + ANT는 스크립트와 구조가 비슷한데, Maven은 선언적
    * 참고로 라이브러리는 배포되는 기술에 따라 이름을 다르게 가질 수 있음 (OSGi가 표준)

## 애플리케이션 아키텍처
### 계층형 아키텍처
- 응집도를 높이고 결합도를 낮추는 시도는 오브젝트 레벨 뿐 아니라, 아키텍처 레벨에서도 적용 가능
    * DAO끼리, 비즈니스 서비스 오브젝트끼리, 웹을 처리하는 코드끼리
    * 성격이 다른 오브젝트 그룹은 아키텍처 레벨에서 분리하는 것이 좋음 (독자적 개발 및 테스트 가능)
- 일반적으로 3계층을 가짐
    1. 데이터 액세스 계층: 백엔드의 DB나 레거시 시스템과 연동하는 인터페이스 역할 `ex. DAO, EIS(Enterprise Information System)`
       * a.k.a. DAO 계층
       * 주된 책임: 장기적 데이터 저장을 위한 DB 이용
       * 추상화 수준에 따라 수직적 계층으로 분할됨: DAO코드 - JdbcTemplate - JDBC/트랜잭션동기화 - DataSource
    2. 서비스 계층: 비즈니스 로직을 담음 `ex. 매니저, 비즈니스 로직`
       * 이상적인 POJO로 작성
       * DAO 계층을 호출하고 이를 활용해서 만들어짐
       * 데이터 액세스 기능 외에 서버/시스템 레벨에서 제공하는 기반 서비스(원격 콜, 메일링 등)를 활용할 때도 있음
       * 도메인의 핵심 비즈니스 로직이 들어있으므로, 타 계층에 종속되지 않아야 함
    3. 프레젠테이션 계층: 웹 기반 UI를 만들고 흐름을 관리함 `ex. 웹, UI, MVC`
       * 가장 복잡함. 웹 기술은 항상 새로운 모델이 등장하며 진보함.
       * 클라이언트 단에 로직이 들어가기도 함 ex. RIA(Rich Internet Application) 등
       * 스프링은 다양한 서드파티 웹 기술을 지원하며, 필요시 스프링을 없애고 다른 기술 사용 가능
- 설계 원칙
    * 각 계층은 자신의 계층의 책임에만 충실해야 한다.
       + 다른 기술의 API 사용 금지
           - DAO 인터페이스는 SQLException이 아니라 래핑한 예외 던질 것
           - 프레젠테이션 계층의 오브젝트인 HttpServletRequest가 아니라 래핑한 객체를 서비스 계층으로 던질 것
       + 계층 사이의 호출은 인터페이스를 통할 것
           - 다른 계층에서 꼭 필요한 메소드만 노출
           - DI는 계층을 구분하지 않으므로, 다른 계층의 오브젝트를 DI하지 않도록 유의

### 애플리케이션 정보 아키텍처
- 독립 애플리케이션은 사용자의 작업 상태를 오래 유지하나, 엔터프라이즈 애플리케이션은 요청을 처리하는 동안만 유지한다.
- 정보를 어떻게 다룰 것인가의 관점에서 아키텍처를 결정할 수 있다.
    1. 데이터로 다루는 경우, 데이터 중심 아키텍처
        * 정보를 단순히 값 or 값을 담기 위한 오브젝트로 취급
        * DB의 정보를 값으로 두고 그 값을 취급하는 코드를 만들고 사용자에게 전달하는 오래된 방식
        * 계층 사이 결합도는 높고 응집도는 떨어지는 특징을 가짐
        * 핵심 비즈니스 로직의 위치에 따라 `DB에 무게를 두는 구조`와 `서비스 코드에 무게를 두는 구조`로 구분
        * DB/SQL 중심
            + 하나의 트랜잭션에 모든 계층의 코드가 종속되는 경향이 있고, 로직 재활용이 어려움
            + 따라서 개발하기 쉽지만, 변화에 취약함
        * 거대한 서비스 계층 방식
            + 복잡한 SQL은 피하고 SQL이 맡던 주요 로직은 서비스 계층에서 처리함
            + 초기 개발 속도가 빠르고 독립적 개발이 가능하며, 자바 언어의 장점을 활용할 수 있고, 테스트하기 쉬움
            + 하지만 계층 간 결합도는 여전히 높고, 객체지향 설계 적용이 어려우며, 코딩 스타일을 통일하기 어렵고, DB/SQL 중심보다 오히려 복잡한 코드를 만들 수 있음
    2. 오브젝트로 다루는 경우
        * 객치제향 분석/모델링으로 도출한 `도메인 모델`을 반영하는 오브젝트 구조를 만들고 이를 계층 간 정보 전송에 사용함